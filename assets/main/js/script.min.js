import{setupMarqueeAnimation}from"../../js/index/marquee.js";document.addEventListener("DOMContentLoaded",()=>{gsap.registerPlugin(ScrollTrigger,SplitText);let r=new Lenis,t=(r.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>r.raf(1e3*e)),gsap.ticker.lagSmoothing(0),gsap.utils.toArray(".card")),o=t[0];gsap.utils.toArray(".card-title h1").forEach(e=>{new SplitText(e,{type:"chars",charsClass:"char",tag:"div"}).chars.forEach(e=>{e.innerHTML=`<span>${e.textContent}</span>`})});let s=o.querySelector(".card-img"),p=o.querySelector(".card-img img");function c(e,r){gsap.to(e,{x:"0%",duration:.75,ease:"power4.out"}),gsap.to(r,{x:0,opacity:1,duration:.75,delay:.1,ease:"power4.out"})}function g(e,r){gsap.to(e,{x:"100%",duration:.5,ease:"power4.out"}),gsap.to(r,{x:"40px",opacity:0,duration:.5,ease:"power4.out"})}gsap.set(s,{scale:.5,borderRadius:"400px"}),gsap.set(p,{scale:1.5});let i=o.querySelector(".card-marquee .marquee"),n=o.querySelectorAll(".char span"),l=o.querySelector(".card-description ");ScrollTrigger.create({trigger:o,start:"top top",end:"+=300vh",markers:!0,onUpdate:e=>{var e=e.progress,r=.5+.5*e,t=400-375*e,a=1.5-.5*e;gsap.set(s,{scale:r,borderRadius:t+"px"}),gsap.set(p,{scale:a}),.5<=r&&r<=.75?(t=(r-.5)/.25,gsap.set(i,{opacity:1-t})):r<.5?gsap.set(i,{opacity:1}):.75<r&&gsap.set(i,{opacity:0}),1<=e&&!o.contentRevealed&&(o.contentRevealed=!0,c(n,l)),e<1&&o.contentRevealed&&(o.contentRevealed=!1,g(n,l))}}),t.forEach((e,r)=>{r=r===t.length-1;ScrollTrigger.create({trigger:e,start:"top top",end:r?"+=100vh":"top top",endTrigger:r?null:t[t.length-1],pin:!0,pinSpacing:r})}),t.forEach((e,r)=>{r<t.length-1&&(e.querySelector(".card-wrapper"),ScrollTrigger.create({trigger:t[r+1],start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(s,{scale:1-.25*e,opacity:1-e})}}))}),t.forEach((e,r)=>{if(0<r){let r=e.querySelector(".card-img img"),t=e.querySelector(".card-img");ScrollTrigger.create({trigger:e,start:"top bottom",end:"top top",onUpdate:e=>{e=e.progress;gsap.set(r,{scale:2-e}),gsap.set(t,{borderRadius:150-125*e+"px"})}})}}),t.forEach((t,e)=>{if(0!==e){let e=t.querySelector(".card-description"),r=t.querySelectorAll(".char span");ScrollTrigger.create({trigger:t,start:"top top",onEnter:()=>c(r,e),onLeave:()=>g(r,e)})}}),setupMarqueeAnimation()});